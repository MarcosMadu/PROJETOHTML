<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>CalendÃ¡rio Semanal â€” Auditor ResponsÃ¡vel (por semana do mÃªs)</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1a2e;
      --card2:#101f38;
      --text:#eaf0ff;
      --muted:#a7b3d6;
      --line:rgba(255,255,255,.10);
      --shadow: 0 18px 50px rgba(0,0,0,.35);
      --radius:18px;

      --accent:#6d5efc;
      --accent2:#22c55e;
      --warn:#f59e0b;
      --danger:#ef4444;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background:
        radial-gradient(1200px 700px at 10% 0%, rgba(109,94,252,.22), transparent 55%),
        radial-gradient(1000px 650px at 95% 25%, rgba(34,197,94,.14), transparent 60%),
        radial-gradient(800px 600px at 50% 110%, rgba(245,158,11,.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }

    .wrap{
      max-width:1100px;
      margin:32px auto;
      padding:0 16px 40px;
    }

    .top{
      display:flex;
      gap:14px;
      align-items:stretch;
      justify-content:space-between;
      flex-wrap:wrap;
      margin-bottom:18px;
    }

    .hero{
      flex:1 1 520px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:16px 16px 14px;
      position:relative;
      overflow:hidden;
    }

    .hero:before{
      content:"";
      position:absolute;
      inset:-2px;
      background:
        radial-gradient(500px 260px at 0% 0%, rgba(109,94,252,.26), transparent 70%),
        radial-gradient(500px 260px at 100% 0%, rgba(34,197,94,.18), transparent 70%);
      pointer-events:none;
      opacity:.85;
    }

    .hero > *{ position:relative; z-index:1; }

    .title{
      display:flex;
      align-items:center;
      gap:12px;
      margin:0 0 6px;
      font-size:18px;
      letter-spacing:.2px;
      flex-wrap:wrap;
    }
    .badge{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:7px 10px;
      border-radius:999px;
      background:rgba(255,255,255,.06);
      border:1px solid var(--line);
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
    }
    .dot{
      width:10px;height:10px;border-radius:50%;
      background: linear-gradient(135deg, var(--accent), #9b8cff);
      box-shadow: 0 0 0 3px rgba(109,94,252,.15);
    }
    .sub{
      margin:0;
      color:var(--muted);
      line-height:1.35;
      font-size:13px;
    }

    .controls{
      flex:1 1 320px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      padding:14px;
      display:flex;
      flex-direction:column;
      gap:12px;
      min-width:310px;
    }

    .row{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
    }

    .btn{
      appearance:none;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      color:var(--text);
      padding:10px 12px;
      border-radius:14px;
      cursor:pointer;
      transition: transform .08s ease, background .18s ease, border-color .18s ease;
      font-weight:700;
      font-size:13px;
      display:inline-flex;
      align-items:center;
      gap:8px;
    }
    .btn:hover{ background:rgba(255,255,255,.10); border-color:rgba(255,255,255,.18); }
    .btn:active{ transform: translateY(1px); }
    .btn.primary{
      border-color:rgba(109,94,252,.35);
      background: linear-gradient(135deg, rgba(109,94,252,.35), rgba(109,94,252,.12));
    }
    .btn.primary:hover{ background: linear-gradient(135deg, rgba(109,94,252,.45), rgba(109,94,252,.16)); }

    .field{
      display:flex;
      flex-direction:column;
      gap:6px;
      flex:1 1 140px;
      min-width:160px;
    }
    label{
      font-size:12px;
      color:var(--muted);
    }
    input[type="date"], input[type="text"], select{
      width:100%;
      border:1px solid var(--line);
      border-radius:14px;
      padding:10px 12px;
      background:rgba(0,0,0,.18);
      color:var(--text);
      outline:none;
    }

    .grid{
      margin-top:16px;
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .gridHead{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      padding:14px 14px 10px;
      border-bottom:1px solid var(--line);
      background:rgba(255,255,255,.04);
      gap:12px;
      flex-wrap:wrap;
    }
    .monthTitle{
      font-size:16px;
      font-weight:900;
      letter-spacing:.3px;
    }
    .meta{
      color:var(--muted);
      font-size:12px;
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
      text-align:right;
    }

    /* Cards por semana */
    .weeks{
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      gap:12px;
      padding:12px;
    }
    @media (max-width: 820px){
      .weeks{ grid-template-columns: 1fr; }
    }

    .weekCard{
      border:1px solid var(--line);
      border-radius:18px;
      background:rgba(0,0,0,.14);
      overflow:hidden;
      position:relative;
      box-shadow: 0 12px 30px rgba(0,0,0,.22);
    }

    .weekCard.current{
      outline:2px solid rgba(34,197,94,.45);
      outline-offset:-2px;
      background:
        radial-gradient(420px 220px at 25% 10%, rgba(34,197,94,.14), transparent 60%),
        rgba(0,0,0,.14);
    }

    .wkTop{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      padding:12px 12px 10px;
      border-bottom:1px solid var(--line);
      background:rgba(255,255,255,.03);
      flex-wrap:wrap;
    }
    .wkTitle{
      font-weight:900;
      letter-spacing:.2px;
      font-size:13px;
    }
    .pill{
      font-size:11px;
      color:var(--muted);
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
      padding:5px 9px;
      border-radius:999px;
      white-space:nowrap;
    }

    .wkBody{
      padding:12px;
      display:flex;
      flex-direction:column;
      gap:10px;
    }

    .auditor{
      padding:12px 12px;
      border-radius:16px;
      border:1px solid rgba(255,255,255,.12);
      background: linear-gradient(135deg, rgba(109,94,252,.20), rgba(109,94,252,.06));
    }
    .auditor .cap{
      font-size:11px;
      color:var(--muted);
      margin-bottom:4px;
      display:flex;
      gap:6px;
      align-items:center;
    }
    .auditor .name{
      font-weight:900;
      letter-spacing:.2px;
      font-size:13px;
      line-height:1.2;
      text-transform:uppercase;
    }

    .rangeGrid{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap:10px;
    }
    .miniCard{
      border:1px solid var(--line);
      background:rgba(255,255,255,.04);
      border-radius:16px;
      padding:10px 10px;
    }
    .miniCard .k{
      color:var(--muted);
      font-size:11px;
      margin-bottom:4px;
    }
    .miniCard .v{
      font-weight:800;
      font-size:12px;
    }

    .legend{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      padding:12px 14px 14px;
      color:var(--muted);
      font-size:12px;
      border-top:1px solid var(--line);
      background:rgba(255,255,255,.03);
      align-items:center;
      justify-content:space-between;
    }
    .chip{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border:1px solid var(--line);
      background:rgba(255,255,255,.06);
    }
    .mini{
      width:10px;height:10px;border-radius:50%;
      background:rgba(34,197,94,.55);
      box-shadow:0 0 0 3px rgba(34,197,94,.12);
    }
    .mini2{
      width:10px;height:10px;border-radius:50%;
      background:rgba(109,94,252,.70);
      box-shadow:0 0 0 3px rgba(109,94,252,.14);
    }

    .footerNote{
      opacity:.85;
      text-align:right;
      max-width:560px;
    }
    @media (max-width: 820px){
      .footerNote{ text-align:left; }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="top">
      <div class="hero">
        <h1 class="title">
          CalendÃ¡rio por Semana do MÃªs â€” Auditor ResponsÃ¡vel
          <span class="badge"><span class="dot"></span>RodÃ­zio automÃ¡tico semanal</span>
        </h1>
        <p class="sub">
          Exibe <b>somente semanas</b> do mÃªs (cards). Cada semana recebe automaticamente 1 responsÃ¡vel
          por <b>rodÃ­zio</b> a partir da <b>data de inÃ­cio</b>. (Opcional: use Seed para embaralhar a ordem uma vez.)
        </p>
      </div>

      <div class="controls">
        <div class="row">
          <button class="btn" id="prevMonth">â¬…ï¸Ž MÃªs</button>
          <button class="btn primary" id="goToday">Hoje</button>
          <button class="btn" id="nextMonth">MÃªs âž¡ï¸Ž</button>
        </div>

        <div class="row">
          <div class="field">
            <label for="startDate">Data de inÃ­cio do rodÃ­zio (recomendado: segunda-feira)</label>
            <input type="date" id="startDate" />
          </div>
          <div class="field">
            <label for="seed">Seed (opcional) p/ embaralhar o rodÃ­zio</label>
            <input type="text" id="seed" placeholder="ex.: 5S-TECNOSONDA-2026" />
          </div>
        </div>

        <div class="row">
          <div class="field" style="min-width:220px">
            <label for="weekRule">Regra de semana</label>
            <select id="weekRule">
              <option value="sunday">Semana: Domingo â†’ SÃ¡bado</option>
              <option value="monday">Semana: Segunda â†’ Domingo</option>
            </select>
          </div>
          <button class="btn primary" id="apply">Aplicar</button>
          <button class="btn" id="copy">Copiar escala do mÃªs</button>
        </div>
      </div>
    </div>

    <div class="grid">
      <div class="gridHead">
        <div class="monthTitle" id="monthTitle">â€”</div>
        <div class="meta">
          <div id="metaWeek">â€”</div>
          <div id="metaOwner">â€”</div>
        </div>
      </div>

      <div class="weeks" id="weeks"></div>

      <div class="legend">
        <div style="display:flex; gap:10px; flex-wrap:wrap; align-items:center;">
          <span class="chip"><span class="mini"></span>Semana atual</span>
          <span class="chip"><span class="mini2"></span>Card do auditor</span>
        </div>
        <div class="footerNote" id="footerNote">â€”</div>
      </div>
    </div>
  </div>

  <script>
    /**
     * LISTA FIXA (conforme vocÃª pediu)
     */
    const PEOPLE = [
      "ALLAN DO NASCIMENTO MORAES",
      "ANDRE DA CONCEICAO ALVES",
      "ANGLA RAKEL SILVA ALMEIDA",
      "ANTONY CHE GUEVARA CAVALCANTE DOS SANTOS",
      "CLEITON DE PAULA BATISTA",
      "DEIVIANE CONCEICAO PEREIRA",
      "EDUARDO DE SOUSA",
      "FERNANDO QUEIROZ DA SILVA",
      "HELIO BARBOSA DOS SANTOS",
      "HERACLITO HENRIQUE SANTANA LOPES",
      "JANAINA KETLEY ANDRADE RIBEIRO",
      "JEOVANE DOS SANTOS SILVA",
      "JORGE MOUZINHO CARVALHO",
      "LUCRECIA SANTOS DO NASCIMENTO",
      "LUIS ANTONIO FELIX DE VASCONCELLOS",
      "MARCELO MONTANDON MARCAL JUNIOR",
      "MARCOS OLIVEIRA MENEZES",
      "RAFAEL HENRIQUE ALVES RIBEIRO",
      "RAPHAEL JOSE PEREIRA DA SILVA",
      "RODRIGO BARBOSA DA SILVA",
      "MARCOS VINICUS BATISTA RIBEIRO",
      "TAINARA BERTUNES DOS SANTOS",
      "VERONICA LUIZA GOMES DE MENEZES",
      "WILDSON DA SILVA BARROS"
    ];

    /**
     * UtilitÃ¡rios
     */
    const pad2 = (n)=> String(n).padStart(2,"0");
    const fmtDateBR = (d)=> `${pad2(d.getDate())}/${pad2(d.getMonth()+1)}/${d.getFullYear()}`;
    function monthNamePT(m){
      return ["Janeiro","Fevereiro","MarÃ§o","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"][m];
    }

    // prÃ³xima segunda-feira (default do inÃ­cio)
    function nextMonday(d=new Date()){
      const x = new Date(d.getFullYear(), d.getMonth(), d.getDate());
      const day = x.getDay(); // 0..6
      const diff = (8 - day) % 7 || 7;
      x.setDate(x.getDate() + diff);
      x.setHours(0,0,0,0);
      return x;
    }

    function isoWeekNumber(date){
      const d = new Date(Date.UTC(date.getFullYear(), date.getMonth(), date.getDate()));
      const dayNum = d.getUTCDay() || 7; // 1..7
      d.setUTCDate(d.getUTCDate() + 4 - dayNum);
      const yearStart = new Date(Date.UTC(d.getUTCFullYear(),0,1));
      const weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
      return { week: weekNo, year: d.getUTCFullYear() };
    }

    // PRNG determinÃ­stico por seed (para embaralhar uma vez a lista)
    function xmur3(str){
      let h = 1779033703 ^ str.length;
      for (let i = 0; i < str.length; i++){
        h = Math.imul(h ^ str.charCodeAt(i), 3432918353);
        h = (h << 13) | (h >>> 19);
      }
      return function(){
        h = Math.imul(h ^ (h >>> 16), 2246822507);
        h = Math.imul(h ^ (h >>> 13), 3266489909);
        h ^= (h >>> 16);
        return h >>> 0;
      };
    }
    function mulberry32(a){
      return function(){
        let t = a += 0x6D2B79F5;
        t = Math.imul(t ^ (t >>> 15), t | 1);
        t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
        return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
      };
    }
    function shuffled(array, seedStr){
      if(!seedStr) return array.slice();
      const seed = xmur3(seedStr)();
      const rnd = mulberry32(seed);
      const a = array.slice();
      for(let i=a.length-1;i>0;i--){
        const j = Math.floor(rnd() * (i+1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    /**
     * Semana - regra selecionÃ¡vel:
     * - sunday: Domingo -> SÃ¡bado
     * - monday: Segunda -> Domingo
     */
    function startOfWeek(date, rule){
      const d = new Date(date.getFullYear(), date.getMonth(), date.getDate());
      d.setHours(0,0,0,0);
      const day = d.getDay(); // 0..6 (Dom..SÃ¡b)
      if(rule === "monday"){
        // converter para segunda como inÃ­cio
        const diff = (day === 0) ? 6 : (day - 1);
        d.setDate(d.getDate() - diff);
        return d;
      }
      // sunday
      d.setDate(d.getDate() - day);
      return d;
    }
    function endOfWeek(date, rule){
      const s = startOfWeek(date, rule);
      const e = new Date(s);
      e.setDate(e.getDate() + 6);
      e.setHours(23,59,59,999);
      return e;
    }

    function weekIndexFromStart(startDate, anyDate, rule){
      const s = startOfWeek(startDate, rule).getTime();
      const w = startOfWeek(anyDate, rule).getTime();
      return Math.floor((w - s) / (7 * 24 * 60 * 60 * 1000));
    }

    function ownerForWeek(people, startDate, dateInWeek, seedStr, rule){
      const list = shuffled(people, seedStr);
      const idx = weekIndexFromStart(startDate, dateInWeek, rule);
      const safe = ((idx % list.length) + list.length) % list.length;
      return { name: list[safe], idx, list };
    }

    function escapeHtml(str){
      return String(str)
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    /**
     * UI Estado
     */
    const elWeeks = document.getElementById("weeks");
    const elMonthTitle = document.getElementById("monthTitle");
    const elMetaWeek = document.getElementById("metaWeek");
    const elMetaOwner = document.getElementById("metaOwner");
    const elFooter = document.getElementById("footerNote");

    const elStartDate = document.getElementById("startDate");
    const elSeed = document.getElementById("seed");
    const elWeekRule = document.getElementById("weekRule");

    const btnPrev = document.getElementById("prevMonth");
    const btnNext = document.getElementById("nextMonth");
    const btnToday = document.getElementById("goToday");
    const btnApply = document.getElementById("apply");
    const btnCopy = document.getElementById("copy");

    const now = new Date();
    let viewYear = now.getFullYear();
    let viewMonth = now.getMonth(); // 0..11

    // Defaults
    (function init(){
      const d = nextMonday(now);
      elStartDate.value = `${d.getFullYear()}-${pad2(d.getMonth()+1)}-${pad2(d.getDate())}`;
      elSeed.value = "";
      elWeekRule.value = "monday"; // padrÃ£o mais comum em escala de trabalho
      render();
    })();

    function getStartDate(){
      const v = elStartDate.value;
      if(!v) return nextMonday(now);
      const [y,m,dd] = v.split("-").map(Number);
      const d = new Date(y, m-1, dd);
      d.setHours(0,0,0,0);
      return d;
    }

    function render(){
      const people = PEOPLE.slice();
      const startDate = getStartDate();
      const seedStr = elSeed.value.trim();
      const rule = elWeekRule.value;

      // CabeÃ§alho
      elMonthTitle.textContent = `${monthNamePT(viewMonth)} ${viewYear}`;

      const iso = isoWeekNumber(now);
      const wOwner = ownerForWeek(people, startDate, now, seedStr, rule).name;
      elMetaWeek.textContent = `Semana ISO atual: ${iso.week}/${iso.year}`;
      elMetaOwner.textContent = `ResponsÃ¡vel da semana atual: ${wOwner}`;
      elFooter.textContent = `InÃ­cio do rodÃ­zio: ${fmtDateBR(startDate)} â€¢ Auditores: ${people.length} â€¢ Regra: ${rule === "monday" ? "Segâ†’Dom" : "Domâ†’SÃ¡b"}`;

      // Semanas Ãºnicas do mÃªs (cards)
      const first = new Date(viewYear, viewMonth, 1);
      const last  = new Date(viewYear, viewMonth + 1, 0);

      const seen = new Set();
      const weeks = [];

      for(let d = new Date(first); d <= last; d.setDate(d.getDate()+1)){
        const ws = startOfWeek(d, rule);
        const key = ws.getTime();
        if(seen.has(key)) continue;
        seen.add(key);

        const we = endOfWeek(d, rule);
        const isoW = isoWeekNumber(d);
        const owner = ownerForWeek(people, startDate, d, seedStr, rule).name;

        weeks.push({
          ws: new Date(ws),
          we: new Date(we),
          isoWeek: isoW.week,
          isoYear: isoW.year,
          owner
        });
      }

      // Render cards
      elWeeks.innerHTML = "";
      const currentWsKey = startOfWeek(now, rule).getTime();

      weeks.forEach((w, i)=>{
        const card = document.createElement("div");
        card.className = "weekCard" + (w.ws.getTime() === currentWsKey ? " current" : "");

        card.innerHTML = `
          <div class="wkTop">
            <div class="wkTitle">Semana ${i+1} do mÃªs</div>
            <div class="pill" title="Semana ISO (referÃªncia)">ISO W${w.isoWeek}/${w.isoYear}</div>
          </div>

          <div class="wkBody">
            <div class="auditor">
              <div class="cap">ðŸ‘¤ ResponsÃ¡vel</div>
              <div class="name">${escapeHtml(w.owner)}</div>
            </div>

            <div class="rangeGrid">
              <div class="miniCard">
                <div class="k">InÃ­cio</div>
                <div class="v">${fmtDateBR(w.ws)}</div>
              </div>
              <div class="miniCard">
                <div class="k">Fim</div>
                <div class="v">${fmtDateBR(w.we)}</div>
              </div>
            </div>

            <div class="miniCard">
              <div class="k">PerÃ­odo</div>
              <div class="v">${fmtDateBR(w.ws)} â€” ${fmtDateBR(w.we)}</div>
            </div>
          </div>
        `;

        elWeeks.appendChild(card);
      });
    }

    function copyMonthSchedule(){
      const people = PEOPLE.slice();
      const startDate = getStartDate();
      const seedStr = elSeed.value.trim();
      const rule = elWeekRule.value;

      const first = new Date(viewYear, viewMonth, 1);
      const last  = new Date(viewYear, viewMonth + 1, 0);

      const seen = new Set();
      const lines = [];
      let n = 0;

      for(let d = new Date(first); d <= last; d.setDate(d.getDate()+1)){
        const ws = startOfWeek(d, rule);
        const key = ws.getTime();
        if(seen.has(key)) continue;
        seen.add(key);
        n++;

        const we = endOfWeek(d, rule);
        const isoW = isoWeekNumber(d);
        const owner = ownerForWeek(people, startDate, d, seedStr, rule).name;

        lines.push(`Semana ${n} â€” ${fmtDateBR(ws)} a ${fmtDateBR(we)} â€” ${owner} (ISO W${isoW.week}/${isoW.year})`);
      }

      const text =
        `Escala (semanal) â€” ${monthNamePT(viewMonth)} ${viewYear}\n` +
        `Regra: ${rule === "monday" ? "Segundaâ†’Domingo" : "Domingoâ†’SÃ¡bado"} | InÃ­cio do rodÃ­zio: ${fmtDateBR(startDate)}\n\n` +
        lines.join("\n");

      navigator.clipboard?.writeText(text).then(()=>{
        btnCopy.textContent = "Copiado âœ“";
        setTimeout(()=> btnCopy.textContent = "Copiar escala do mÃªs", 1200);
      }).catch(()=>{
        alert("NÃ£o foi possÃ­vel copiar automaticamente. Copie manualmente:\n\n" + text);
      });
    }

    // Eventos
    btnPrev.addEventListener("click", ()=>{
      viewMonth--;
      if(viewMonth < 0){ viewMonth = 11; viewYear--; }
      render();
    });
    btnNext.addEventListener("click", ()=>{
      viewMonth++;
      if(viewMonth > 11){ viewMonth = 0; viewYear++; }
      render();
    });
    btnToday.addEventListener("click", ()=>{
      viewYear = now.getFullYear();
      viewMonth = now.getMonth();
      render();
    });
    btnApply.addEventListener("click", render);
    btnCopy.addEventListener("click", copyMonthSchedule);
  </script>
</body>
</html>
